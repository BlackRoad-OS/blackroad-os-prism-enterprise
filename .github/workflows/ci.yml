name: CI
on: [pull_request]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - run: corepack enable || true
      - run: pnpm -v || npm i -g pnpm
      - run: pnpm install --ignore-scripts || npm install
      - run: pnpm -r build || npm run build --workspaces || true
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - run: pnpm -r test --if-present || npm test --workspaces || true
      - run: pytest -q || true
  lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - run: pnpm dlx eslint . --ext .ts,.tsx,.js || true
  policy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - run: echo "opa eval would run here" # placeholder; keep alias 'policy'
